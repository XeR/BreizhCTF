#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include <string.h>
#include <unistd.h>
#include <linux/limits.h>
#include <limits.h>

/**
 * Function called to show usage
 * It writes how to use this software, and some examples.
 *
 * @param  char* argv0 Absolute, or relative program name
 * @return EXIT_FAILURE
 */
int
showUsage(char* argv0)
{
	char path[PATH_MAX];

	if(argv0[0] == '/')
		strncpy(path, argv0, PATH_MAX);
	else {
		getcwd(path,         PATH_MAX);
		strncat(path, "/",   PATH_MAX);
		strncat(path, argv0, PATH_MAX);
	}

	fprintf(stderr, "Usage: %s <words> ...\n", path);
	fprintf(stderr, "Example: %s kayak abba racecar\n", path);
	fprintf(stderr, "Checks if words are palindromes.\n");

	return EXIT_FAILURE;
}

/**
 * Function called to check wether a string is a palindrome
 * A palindrome is a word, or sentence that can be written backward, and will
 * still be the same.
 * I am new to code, so it only checks a word. :(
 *
 * @param  char*  string String to check
 * @param  size_t length Length of string
 * @return 1 if the word is a palindrome, 0 otherwise.
 */

int
isPalindrome(const char* string, const size_t length)
{
	if(length <= 1)
		return 1;

	if(string[0] != string[length - 1])
		return 0;

	return isPalindrome(&string[1], length - 2);
}

/**
 * This program tells if a list of words is a palindrom
 *
 * @author XeR
 */

int
main(int argc, char* argv[])
{
	int i;

#ifdef DEBUG
	fprintf(stderr, "Last compilation: %s %s\n", __DATE__, __TIME__);
#endif

	if(argc < 2)
		return showUsage(argv[0]);

	for(i = 1; i < argc; i++)
		printf("Word %d (%s) %s\x1B[0m a palindrome.\n",
			i,
			argv[i],
			isPalindrome(argv[i], strlen(argv[i])) ? "\x1B[32mIS" : "\x1B[31mIS NOT"
		);

	return EXIT_SUCCESS;
}
